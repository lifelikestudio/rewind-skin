<section class="large-header-section large-header-section--shop">
  <div class="large-header-section__inner wrapper wrapper--md">
    <div class="large-header-section__container">
      <h1 class="large-heading large-heading--shop">Shop</h1>
    </div>
    <div class="large-header-section__container">
      {%- if collection.handle != 'all' -%}
        {%- if collection.handle == 'biologique-recherche' or collection.handle == 'gifting' or collection.handle == 'bestsellers' or collection.handle == 'sales-offers'
        -%}
          <p class="all-caps collections__breadcrumbs">
            <a href="/collections/all">Shop</a>
            / Featured / {{ collection.title }}
          </p>
        {%- elsif collection.handle == 'face' or collection.handle == 'bath-body-hair' -%}
          <p class="all-caps collections__breadcrumbs">
            <a href="/collections/all">Shop</a>
            / Areas / {{ collection.title }}
          </p>
        {%- else -%}
          <p class="all-caps collections__breadcrumbs">
            <a href="/collections/all">Shop</a>
            / {{ collection.title }}
          </p>
        {%- endif -%}
      {%- else -%}
        <p class="all-caps collections__breadcrumbs">Shop / All</p>
      {%- endif -%}
      <p class="header-description--shop">
        A solution for every concern. Explore our extensive range of carefully curated luxury products; from hydrating   
        to correcting, we've got you covered.
      </p>
    </div>
  </div>
</section>
<main class="collections__main wrapper wrapper--lg">
  <div class="collections__container">
    <form class="collections__filter-form collections__filter-form--desktop">
      <div class="collections__filter-group">
        <h2 class="all-caps collections__filter-group-title">Featured</h2>
        <div class="collections__filter-group-options">
          <ul class="filter-group-options__list">
            <li class="all-caps filter-group-options__list-item">
              <a href="/collections/biologique-recherche">Biologique Recherche</a>
            </li>
            <li class="all-caps filter-group-options__list-item">
              <a href="/collections/gifting">Gifting</a>
            </li>
            <li class="all-caps filter-group-options__list-item">
              <a href="/collections/bestsellers">Bestsellers</a>
            </li>
            <li class="all-caps filter-group-options__list-item">
              <a href="/collections/sales-offers">Sales & Offers</a>
            </li>
          </ul>
        </div>
      </div>

      {%- for filter in collection.filters -%}
        {%- if filter.label == 'Categories' -%}
          <div class="collections__filter-group">
            <h2 class="all-caps collections__filter-group-title">{{ filter.label }}</h2>
            <div class="collections__filter-group-options">
              {%- case filter.type -%}
                {%- when 'list' -%}
                  <ul class="filter-group-options__list">
                    {%- for filter_value in filter.values -%}
                      <li class="all-caps filter-group-options__list-item">
                        <label for="Filter-desktop-{{ filter.param_name }}-{{ forloop.index }}">
                          <input
                            type="checkbox"
                            name="{{ filter_value.param_name }}"
                            value="{{ filter_value.value }}"
                            id="Filter-desktop-{{ filter.param_name }}-{{ forloop.index }}"
                            {% if filter_value.active -%}
                            checked
                            {%- endif %}
                            {% if filter_value.count == 0 and filter_value.active == false -%}
                            disabled
                            {%- endif %}>
                          {% assign label_characters = filter_value.label | join: ', ' | replace: '_', ', ' | replace: 'plus', '+'
                          %}
                          <span class="filter-group-options__label">
                            {{- label_characters -}}
                            {{ ' ' }} ({{ filter_value.count }})
                          </span>
                        </label>
                      </li>
                    {%- endfor -%}
                  </ul>
              {%- endcase -%}
            </div>
          </div>
        {%- endif -%}
      {%- endfor -%}

      <div class="collections__filter-group">
        <h2 class="all-caps collections__filter-group-title">Areas</h2>
        <div class="collections__filter-group-options">
          <ul class="filter-group-options__list">
            <li class="all-caps filter-group-options__list-item">
              <a href="/collections/face">Face</a>
            </li>
            <li class="all-caps filter-group-options__list-item">
              <a href="/collections/bath-body-hair">Bath, Body & Hair</a>
            </li>
            <li class="all-caps filter-group-options__list-item">
              <a href="/collections/all">Shop All</a>
            </li>
          </ul>
        </div>
      </div>

      {%- for filter in collection.filters -%}
        {%- if filter.label != 'Categories' -%}
          <div class="collections__filter-group">
            <h2 class="all-caps collections__filter-group-title">{{ filter.label }}</h2>
            <div class="collections__filter-group-options">
              {%- case filter.type -%}
                {%- when 'list' -%}
                  <ul class="filter-group-options__list">
                    {%- for filter_value in filter.values -%}
                      <li class="all-caps filter-group-options__list-item">
                        <label for="Filter-desktop-{{ filter.param_name }}-{{ forloop.index }}">
                          <input
                            type="checkbox"
                            name="{{ filter_value.param_name }}"
                            value="{{ filter_value.value }}"
                            id="Filter-desktop-{{ filter.param_name }}-{{ forloop.index }}"
                            {% if filter_value.active -%}
                            checked
                            {%- endif %}
                            {% if filter_value.count == 0 and filter_value.active == false -%}
                            disabled
                            {%- endif %}>
                          {% assign label_characters = filter_value.label | join: ', ' | replace: '_', ', ' | replace: 'plus', '+'
                          %}
                          <span class="filter-group-options__label">
                            {{- label_characters -}}
                            {{ ' ' }} ({{ filter_value.count }})
                          </span>
                        </label>
                      </li>
                    {%- endfor -%}
                  </ul>
              {%- endcase -%}
            </div>
          </div>
        {%- endif -%}
      {%- endfor -%}
    </form>

    <button class="all-caps collections__filters-action" id="refine-action">Refine</button>
    <button class="all-caps collections__filters-action" id="sort-action">Sort</button>

    <div class="drawer drawer--menu drawer--filters" id="mobile-refine">
      <div class="drawer__header">
        <h2 class="drawer__top-level-heading">Refine</h2>
        <button class="all-caps drawer__header-action" id="refine-close">Close</button>
      </div>
      <ul class="drawer__container">
        <li class="drawer__menu">
          <ul class="drawer__links-list">
            <li class="drawer__link">
              <button class="all-caps" id="featured-mobile-action">Featured</button>
            </li>
            <li class="drawer__link">
              <button class="all-caps" id="categories-mobile-action">Categories</button>
            </li>
            <li class="drawer__link">
              <button class="all-caps" id="areas-mobile-action">Areas</button>
            </li>
            <li class="drawer__link">
              <button class="all-caps" id="types-mobile-action">Skin Types</button>
            </li>
            <li class="drawer__link">
              <button class="all-caps" id="concerns-mobile-action">Skin Concerns</button>
            </li>
            <li class="drawer__link">
              <button class="all-caps" id="brands-mobile-action">Brands</button>
            </li>
          </ul>
        </li>
      </ul>
    </div>
    <form action="" class="collections__filter-form collections__filter-form--mobile">
      <div class="drawer drawer--menu" id="filters-featured-menu">
        <div class="drawer__header">
          <button type="button" class="all-caps drawer__header-action menu-back">Back</button>
          <h2 class="drawer__top-level-heading">Featured</h2>
          <button
            type="button"
            class="all-caps drawer__header-action"
            id="featured-close">
            Close
          </button>
        </div>
        <div class="drawer__container drawer__menu">
          <ul class="drawer__links-list">
            <li class="all-caps drawer__link">
              <a href="/collections/biologique-recherche">Biologique Recherche</a>
            </li>
            <li class="all-caps drawer__link">
              <a href="#">Gifting</a>
            </li>
            <li class="all-caps drawer__link">
              <a href="/collections/bestsellers">Bestsellers</a>
            </li>
            <li class="all-caps drawer__link">
              <a href="/collections/sales-offers">Sales & Offers</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="drawer drawer--menu" id="filters-areas-menu">
        <div class="drawer__header">
          <button type="button" class="all-caps drawer__header-action menu-back">Back</button>
          <h2 class="drawer__top-level-heading">Areas</h2>
          <button
            type="button"
            class="all-caps drawer__header-action"
            id="areas-close">
            Close
          </button>
        </div>
        <div class="drawer__container drawer__menu">
          <ul class="drawer__links-list">
            <li class="all-caps drawer__link">
              <a href="/collections/face">Face</a>
            </li>
            <li class="all-caps drawer__link">
              <a href="/collections/bath-body-hair">Bath, Body & Hair</a>
            </li>
            <li class="all-caps drawer__link">
              <a href="/collections/all">Shop All</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="drawer drawer--menu" id="filters-categories-menu">
        <div class="drawer__header">
          <button type="button" class="all-caps drawer__header-action menu-back">Back</button>
          {%- for filter in collection.filters -%}
            {%- assign downcased_label = filter.label | downcase -%}
            {%- if downcased_label == 'categories' -%}
              <h2 class="drawer__top-level-heading">{{ filter.label }}</h2>
            {%- endif -%}
          {%- endfor -%}
          <button
            type="button"
            class="all-caps drawer__header-action"
            id="categories-close">
            Close
          </button>
        </div>
        <div class="drawer__container drawer__menu">
          {%- for filter in collection.filters -%}
            {%- assign downcased_label = filter.label | downcase -%}
            {%- if downcased_label == 'categories' -%}
              {%- case filter.type -%}
                {%- when 'list' -%}
                  <ul class="drawer__links-list">
                    {%- for filter_value in filter.values -%}
                      <li class="all-caps drawer__link">
                        <label for="Filter-mobile-{{ filter.param_name }}-{{ forloop.index }}">
                          <input
                            type="checkbox"
                            name="{{ filter_value.param_name }}"
                            value="{{ filter_value.value }}"
                            id="Filter-mobile-{{ filter.param_name }}-{{ forloop.index }}"
                            {% if filter_value.active -%}
                            checked
                            {%- endif %}
                            {% if filter_value.count == 0 and filter_value.active == false -%}
                            disabled
                            {%- endif %}>
                          {% assign label_with_commas = filter_value.label | join: ', ' | replace: '_', ', ' %}

                          <span class="filter-group-options__label">
                            {{- label_with_commas -}}
                            {{ ' ' }} ({{ filter_value.count }})
                          </span>
                        </label>
                      </li>
                    {%- endfor -%}
                  </ul>
              {%- endcase -%}
            {%- endif -%}
          {%- endfor -%}
        </div>
      </div>
      <div class="drawer drawer--menu" id="filters-concerns-menu">
        <div class="drawer__header">
          <button type="button" class="all-caps drawer__header-action menu-back">Back</button>
          {%- for filter in collection.filters -%}
            {%- assign downcased_label = filter.label | downcase -%}
            {%- if downcased_label == 'skin concerns' -%}
              <h2 class="drawer__top-level-heading">{{ filter.label }}</h2>
            {%- endif -%}
          {%- endfor -%}
          <button
            type="button"
            class="all-caps drawer__header-action"
            id="concerns-close">
            Close
          </button>
        </div>
        <div class="drawer__container drawer__menu">
          {%- for filter in collection.filters -%}
            {%- assign downcased_label = filter.label | downcase -%}
            {%- if downcased_label == 'skin concerns' -%}
              {%- case filter.type -%}
                {%- when 'list' -%}
                  <ul class="drawer__links-list">
                    {%- for filter_value in filter.values -%}
                      <li class="all-caps drawer__link">
                        <label for="Filter-mobile-{{ filter.param_name }}-{{ forloop.index }}">
                          <input
                            type="checkbox"
                            name="{{ filter_value.param_name }}"
                            value="{{ filter_value.value }}"
                            id="Filter-mobile-{{ filter.param_name }}-{{ forloop.index }}"
                            {% if filter_value.active -%}
                            checked
                            {%- endif %}
                            {% if filter_value.count == 0 and filter_value.active == false -%}
                            disabled
                            {%- endif %}>
                          {% assign label_with_plus = filter_value.label | replace: 'plus', '+' %}

                          <span class="filter-group-options__label">
                            {{- label_with_plus -}}
                            {{ ' ' }} ({{ filter_value.count }})
                          </span>
                        </label>
                      </li>
                    {%- endfor -%}
                  </ul>
              {%- endcase -%}
            {%- endif -%}
          {%- endfor -%}
        </div>
      </div>
      <div class="drawer drawer--menu" id="filters-types-menu">
        <div class="drawer__header">
          <button type="button" class="all-caps drawer__header-action menu-back">Back</button>
          {%- for filter in collection.filters -%}
            {%- assign downcased_label = filter.label | downcase -%}
            {%- if downcased_label == 'skin types' -%}
              <h2 class="drawer__top-level-heading">{{ filter.label }}</h2>
            {%- endif -%}
          {%- endfor -%}
          <button
            type="button"
            class="all-caps drawer__header-action"
            id="types-close">
            Close
          </button>
        </div>
        <div class="drawer__container drawer__menu">
          {%- for filter in collection.filters -%}
            {%- assign downcased_label = filter.label | downcase -%}
            {%- if downcased_label == 'skin types' -%}
              {%- case filter.type -%}
                {%- when 'list' -%}
                  <ul class="drawer__links-list">
                    {%- for filter_value in filter.values -%}
                      <li class="all-caps drawer__link">
                        <label for="Filter-mobile-{{ filter.param_name }}-{{ forloop.index }}">
                          <input
                            type="checkbox"
                            name="{{ filter_value.param_name }}"
                            value="{{ filter_value.value }}"
                            id="Filter-mobile-{{ filter.param_name }}-{{ forloop.index }}"
                            {% if filter_value.active -%}
                            checked
                            {%- endif %}
                            {% if filter_value.count == 0 and filter_value.active == false -%}
                            disabled
                            {%- endif %}>
                          {% assign label_with_plus = filter_value.label | replace: 'plus', '+' %}

                          <span class="filter-group-options__label">
                            {{- label_with_plus -}}
                            {{ ' ' }} ({{ filter_value.count }})
                          </span>
                        </label>
                      </li>
                    {%- endfor -%}
                  </ul>
              {%- endcase -%}
            {%- endif -%}
          {%- endfor -%}
        </div>
      </div>
      <div class="drawer drawer--menu" id="filters-brands-menu">
        <div class="drawer__header">
          <button type="button" class="all-caps drawer__header-action menu-back">Back</button>
          {%- for filter in collection.filters -%}
            {%- assign downcased_label = filter.label | downcase -%}
            {%- if downcased_label == 'brands' -%}
              <h2 class="drawer__top-level-heading">{{ filter.label }}</h2>
            {%- endif -%}
          {%- endfor -%}
          <button
            type="button"
            class="all-caps drawer__header-action"
            id="brands-close">
            Close
          </button>
        </div>
        <div class="drawer__container drawer__menu">
          {%- for filter in collection.filters -%}
            {%- assign downcased_label = filter.label | downcase -%}
            {%- if downcased_label == 'brands' -%}
              {%- case filter.type -%}
                {%- when 'list' -%}
                  <ul class="drawer__links-list">
                    {%- for filter_value in filter.values -%}
                      <li class="all-caps drawer__link">
                        <label for="Filter-mobile-{{ filter.param_name }}-{{ forloop.index }}">
                          <input
                            type="checkbox"
                            name="{{ filter_value.param_name }}"
                            value="{{ filter_value.value }}"
                            id="Filter-mobile-{{ filter.param_name }}-{{ forloop.index }}"
                            {% if filter_value.active -%}
                            checked
                            {%- endif %}
                            {% if filter_value.count == 0 and filter_value.active == false -%}
                            disabled
                            {%- endif %}>
                          {% assign label_with_commas = filter_value.label | join: ', ' | replace: '_', ', ' %}

                          <span class="filter-group-options__label">
                            {{- label_with_commas -}}
                            {{ ' ' }} ({{ filter_value.count }})
                          </span>
                        </label>
                      </li>
                    {%- endfor -%}
                  </ul>
              {%- endcase -%}
            {%- endif -%}
          {%- endfor -%}
        </div>
      </div>
    </form>
    <div class="drawer-filters__clear-apply" id="filters-clear-apply">
      <a class="btn btn--primary all-caps drawer-filters__btn drawer-filters__btn--clear" href="{{ collection.url }}?sort_by={{ collection.sort_by }}">Clear Filters</a>
      <button class="btn btn--secondary all-caps drawer-filters__btn drawer-filters__btn--apply" id="filters-show-results">
        View Results
      </button>
    </div>
  </div>
  <div class="collections__container">
    <div
      class="collections__products"
      id="collections-products-container"
      data-collection-handle="{{ collection.handle }}">
      {% paginate collection.products by 24 %}
        {% for product in collection.products %}
          {% for variant in product.variants %}
            {% assign url_parts = product.url | split: '?' %}
            {% assign base_url = url_parts[0] %}
            {% assign query_params = url_parts[1] | default: '' %}

            {% if query_params != '' %}
              {% assign variant_url = product.url | append: '&variant=' | append: variant.id %}
            {% else %}
              {% assign variant_url = product.url | append: '?variant=' | append: variant.id %}
            {% endif %}

            <a href="{{ variant_url }}" class="product-card">
              <div class="product-card__info">
                <p class="all-caps product-card__brand">{{ product.vendor }}</p>
                <h2 class="product-card__product">
                  {{ product.title -}}
                  {%- if variant.title != 'Default Title' %}
                    / {{ variant.title }}
                  {% endif %}
                </h2>
              </div>

              {% assign downcased_vendor = product.vendor | strip | downcase %}
              {% if downcased_vendor == 'biologique recherche' and localization.country.code != 'CA' %}
                <div class="all-caps btn btn--primary product-card__btn product-card__btn--icon" data-url="{{ variant_url }}">
                  Exclusive to Canada
                </div>
              {% elsif variant.available %}
                <form
                  action="/cart/add"
                  method="post"
                  class="product-card__form">
                  <input
                    type="hidden"
                    name="id"
                    value="{{ variant.id }}">
                  <button class="all-caps btn btn--primary product-card__btn">
                    {% if product.compare_at_price > variant.price %}
                      <span>Add to Bag</span>
                      <span class="product-card__sale-price">
                        <del>{{ product.compare_at_price | money_with_currency | remove: '.00' }}</del>
                        <ins>{{ variant.price | money_with_currency | remove: '.00' }}</ins>
                      </span>
                    {% else %}
                      <span>Add to Bag</span>
                      <span>{{ variant.price | money_with_currency | remove: '.00' }}</span>
                    {% endif %}
                  </button>
                </form>
              {% else %}
                <div class="all-caps btn btn--primary product-card__btn product-card__btn--sold-out">Out of Stock</div>
            {% endif %}

              {% comment %}
                <!-- Original Code -->
                {% if variant.image != blank %}
                <img
                class="product-card__image"
                src="{{ variant.image | image_url: width: 780 }}"
                width="780"
                height="1170"
                loading="lazy">
                {% else %}
                <img
                class="product-card__image"
                src="{{ product.featured_image | image_url: width: 780 }}"
                width="780"
                height="1170"
                loading="lazy">
                {% endif %}
              {% endcomment %}

              {% assign primary_option_value = variant.option1 | downcase %}

              {% if primary_option_value contains '$' %}
                {% assign primary_option_value = primary_option_value | remove_first: '$' | strip %}
              {% endif %}

              {% assign primary_option_value = primary_option_value | replace: '/', '-' %}

              {% assign primary_option_value = primary_option_value | replace: 'á', 'a' | replace: 'à', 'a' | replace: 'â', 'a' | replace: 'ã', 'a' | replace: 'ä', 'a' | replace: 'å', 'a' | replace: 'ā', 'a' | replace: 'ă', 'a' | replace: 'ȧ', 'a' | replace: 'ạ', 'a' | replace: 'ą', 'a' | replace: 'ả', 'a' | replace: 'ȃ', 'a'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'é', 'e' | replace: 'è', 'e' | replace: 'ê', 'e' | replace: 'ë', 'e' | replace: 'ē', 'e' | replace: 'ĕ', 'e' | replace: 'ė', 'e' | replace: 'ẹ', 'e' | replace: 'ę', 'e' | replace: 'ẻ', 'e' | replace: 'ȅ', 'e' | replace: 'ȇ', 'e' | replace: 'ě', 'e'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'í', 'i' | replace: 'ì', 'i' | replace: 'î', 'i' | replace: 'ï', 'i' | replace: 'ī', 'i' | replace: 'ĭ', 'i' | replace: 'ị', 'i' | replace: 'ỉ', 'i' | replace: 'į', 'i' | replace: 'ȉ', 'i' | replace: 'ȋ', 'i'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ó', 'o' | replace: 'ò', 'o' | replace: 'ô', 'o' | replace: 'õ', 'o' | replace: 'ö', 'o' | replace: 'ō', 'o' | replace: 'ŏ', 'o' | replace: 'ȯ', 'o' | replace: 'ọ', 'o' | replace: 'ỏ', 'o' | replace: 'ơ', 'o' | replace: 'ø', 'o' | replace: 'ő', 'o' | replace: 'ǒ', 'o' | replace: 'ȍ', 'o' | replace: 'ȏ', 'o'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ú', 'u' | replace: 'ù', 'u' | replace: 'û', 'u' | replace: 'ü', 'u' | replace: 'ū', 'u' | replace: 'ŭ', 'u' | replace: 'ů', 'u' | replace: 'ű', 'u' | replace: 'ụ', 'u' | replace: 'ų', 'u' | replace: 'ủ', 'u' | replace: 'ư', 'u' | replace: 'ȕ', 'u' | replace: 'ȗ', 'u'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ý', 'y' | replace: 'ÿ', 'y' | replace: 'ȳ', 'y' | replace: 'ỳ', 'y' | replace: 'ỷ', 'y' | replace: 'ỵ', 'y' | replace: 'ỹ', 'y' | replace: 'ŷ', 'y'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ç', 'c' | replace: 'ć', 'c' | replace: 'ĉ', 'c' | replace: 'ċ', 'c' | replace: 'č', 'c'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ď', 'd' | replace: 'ḍ', 'd' | replace: 'đ', 'd' | replace: 'ȡ', 'd'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ĝ', 'g' | replace: 'ğ', 'g' | replace: 'ġ', 'g' | replace: 'ǧ', 'g'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ĥ', 'h' | replace: 'ȟ', 'h' | replace: 'ḥ', 'h' | replace: 'ħ', 'h' | replace: 'ɦ', 'h'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ĵ', 'j' | replace: 'ǰ', 'j' %}

              {% assign primary_option_value = primary_option_value | replace: 'ķ', 'k' | replace: 'ḳ', 'k' | replace: 'ǩ', 'k'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ĺ', 'l' | replace: 'ľ', 'l' | replace: 'ļ', 'l' | replace: 'ḷ', 'l' | replace: 'ł', 'l'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ṁ', 'm' %}

              {% assign primary_option_value = primary_option_value | replace: 'ń', 'n' | replace: 'ņ', 'n' | replace: 'ň', 'n' | replace: 'ṅ', 'n' | replace: 'ṇ', 'n'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ŕ', 'r' | replace: 'ř', 'r' | replace: 'ŗ', 'r' | replace: 'ṛ', 'r'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ś', 's' | replace: 'š', 's' | replace: 'ş', 's' | replace: 'ṣ', 's' | replace: 'ș', 's'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ť', 't' | replace: 'ţ', 't' | replace: 'ṭ', 't' | replace: 'ț', 't' | replace: 'ŧ', 't' | replace: 'ȶ', 't'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ŵ', 'w' | replace: 'ẁ', 'w' | replace: 'ẃ', 'w' | replace: 'ẅ', 'w' | replace: 'ẇ', 'w' | replace: 'ẉ', 'w'
              %}

              {% assign primary_option_value = primary_option_value | replace: 'ź', 'z' | replace: 'ż', 'z' | replace: 'ž', 'z' | replace: 'ẓ', 'z'
              %}

              {% assign normalized_primary_option = primary_option_value | replace: "'", '-' | replace: "'", '-' | replace: ' ', '-' | replace: '.', '-' | replace: '/', '-' | replace: '--', '-' | replace: '--', '-' | downcase
              %}

              {% comment %} Use the normalized primary option to match images {% endcomment %}
              {% for image in product.images %}
                {% if image.src contains 'product-card' and image.src contains normalized_primary_option %}
                  <img
                    class="product-card__image"
                    src="{{ image | img_url: '780x1170' }}"
                    width="780"
                    height="1170"
                    loading="lazy">
                  {% break %}
                {% endif %}
              {% endfor %}
            </a>
          {% endfor %}
        {% endfor %}

        <div class="pagination">
          {% if paginate.previous %}
            <a class="all-caps" href="{{ paginate.previous.url }}">Previous</a>
          {% endif %}
          {% for part in paginate.parts %}
            {% if part.is_link %}
              <a href="{{ part.url }}">{{ part.title }}</a>
            {% else %}
              <span>{{ part.title }}</span>
            {% endif %}
          {% endfor %}
          {% if paginate.next %}
            <a class="all-caps" href="{{ paginate.next.url }}">Next</a>
          {% endif %}
        </div>
      {% endpaginate %}
    </div>
  </div>
</main>
{% section 'skin-analysis' %}
{% section 'treatments' %}
{% section 'opt-in' %}